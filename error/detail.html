<!DOCTYPE html>
<html lang="hi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="Cache-Control" content="public, max-age=600">
    <title>एक पेड़ माँ के नाम – Eco Clubs for Mission LiFE</title>
    <link rel="stylesheet" href="./index.css" />
    <link rel="icon" href="./favicon.jpg" type="image/jpg" />


  </head>

  <body>
    
    <header class="header">
  <a href="https://ecoclubs.education.gov.in" >
    <img src="./Logo-2.png" alt="Eco Clubs For Mission LiFE" />
  </a>
  <a href="https://dsel.education.gov.in/" >
    <img src="./schoolEdu-logo.png" alt="DSEL" />
  </a>
  <a href="https://samagra.education.gov.in/" >
    <img src="./samagra-logo.png" alt="Samagra Shiksha" />
  </a>
  <a href="https://pmshri.education.gov.in/" >
    <img src="./pmshree-logo.png" alt="PM SHRI" />
  </a>
</header>

    <div class="landing-link" >
      <a href="https://ecoclubs.education.gov.in/main">
        Click here to Go to
        <span class="highlight">Eco Clubs for Mission LiFE</span> Landing Page
      </a>
      <br />
   <button onclick="openHelplineModal()" style="
    padding: 8px 16px;
    background: #1976d2;
    color: #fff;
    border: none;
    border-radius: 4px;
    cursor: pointer;
  ">View Helpline Numbers</button>

    </div>

    <section class="stackHolderSec2 uploadImg">
      <div class="row">
        <div class="col-left">
          <div style="display: flex; justify-content: flex-start">
            <h2 class="title">
              <span>Ek Ped </span> <span>Maa Ke Naam 2.0</span>
            </h2>
            <h2 class="title" style="margin: 0 6px">||</h2>
            <h2 class="title">
              <span>एक पेड़</span> <span>माँ के नाम 2.0</span>
            </h2>

                    
          </div>
          <div class="description">
            <p>
              The essence of 'Ek Ped Maa Ke Naam' is a symbolic gesture—planting
              a tree in the name of one's mother. This simple act serves a dual
              purpose: honoring the role of mothers in nurturing life and
              contributing to the health of the planet. Trees are
              life-sustaining, and just like a mother, they provide sustenance,
              protection, and a future for the next generation. Through this
              initiative, participants not only create a lasting memory in the
              honour of their mother, but also are addressing the pressing need
              for environmental preservation.
            </p>
          </div>

          <div
            class="flexWrap"
            style="
              display: flex;
              justify-content: flex-start;
              align-items: center;
            "
          >
            
<div class="media-slider" id="mediaSlider">

  <button class="nav prev" aria-label="Previous slide">&#10094;</button>



  <div class="slides">

    <!-- Slide 1: Video -->

    <div class="slide active">

      <video

      muted 

       id="promoVideo"

  autoplay

  playsinline

  controls

  preload="metadata"

  style="width:100%;height:auto;object-fit:cover;display:block;border-radius:8px;"

>

  <source src="https://ecoclubs.education.gov.in/viewUpload/uploads/videos/WhatsApp%20Video%202025-08-09%20at%2019.04.22_2167d68e.mp4" type="video/mp4">

  Your browser does not support the video tag.

</video>



    </div>



    <!-- Slide 2: Existing image -->

    <div class="slide">

      <img

        src="https://ecoclubsmissionlife.blob.core.windows.net/ecoclubs-missionlife-container/eco-club-logo_20250724_205208.jpg?sp=r&st=2025-08-19T15:14:18Z&se=2026-12-30T23:29:18Z&spr=https&sv=2024-11-04&sr=c&sig=nZE%2BPBAMO2sKIFrNP80OjvYYY7bojSBMTvspPIPLVsg%3D"

        alt="Planting"

        loading="lazy"

        class="media-thumb"

      />

    </div>



    <!-- Add more slides by duplicating a .slide and swapping src -->

    <!--

    <div class="slide">

      <img src="./another-image.jpg" alt="Caption" loading="lazy" />

    </div>

    -->

  </div>



  <button class="nav next" aria-label="Next slide">&#10095;</button>

  <div class="dots" id="mediaDots"></div>

</div>
            <div>
              <section class="sevenScopeSec" style="margin-top: 0">
                <div class="sevenScopeBox">
                  <ul>
                    <li>
                      <div>
                        <div class="themeUploaded">
                          <div class="uploadedtitled" id="totalImagesUploaded">--</div>
                        </div>
                        <div class="themeBoxCnt">Total Saplings Planted</div>
                      </div>
                    </li>
                    <li>
                      <div ">
                        <div class="themeUploaded">
                          <div class="uploadedtitled" id="certificatesDownloaded">--</div>
                        </div>
                        <div class="themeBoxCnt">Schools Participated</div>
                      </div>
                    </li>
                    <li>
                      <div ">
                        <div class="themeUploaded">
                          <div class="uploadedtitled" id="notificationCount">--</div>
                        </div>
                        <div class="themeBoxCnt">Notifications Uploaded</div>
                      </div>
                    </li>
                   
                  </ul>
                </div>
              </section>
             <div style="display: flex; gap: 16px;">
  <div class="uplodedImages">
                <p>View Photo Gallery</p>
                <button
                  class="button orange"
                  onclick="location.href='https://ecoclubs.education.gov.in/view-images'"
                >
                  View Photo Gallery
                </button>
              </div>
  <div style="flex: 1; display: flex; align-items: flex-start; margin-top: 40px;">
    <button
      class="button green"
      style="width: 100%; white-space: normal;"
      onclick="window.open('https://ecoclubsmissionlife.blob.core.windows.net/ecoclubs-missionlife-container/ek%20ped%20.mp4?sp=r&st=2025-08-19T15:14:18Z&se=2026-12-30T23:29:18Z&spr=https&sv=2024-11-04&sr=c&sig=nZE%2BPBAMO2sKIFrNP80OjvYYY7bojSBMTvspPIPLVsg%3D')"
    >
      Click here to play tutorial Video for Ek Ped Maa Ke Naam 2.0 initiative.
    </button>
  </div>
</div></div>
          </div>
        </div>
        <div class="col-right">
          <div class="form-container">
            <h2>Join the Movement – Ek Ped Maa Ke Naam 2.0 Participation Form</h2>
            <!-- <div style="margin-bottom: 5px; display: flex; align-items: center; gap: 10px;">
              <label style="font-size: 0.9em; color: #333;">
                <input type="radio" name="userType" value="student" checked style="transform: scale(0.8); margin-right: 4px;">
              </label>
              <span style="font-size: 0.9em; color: #333;">Student</span>
              
              <label style="font-size: 0.9em; color: #333;">
                <input type="radio" name="userType" value="other" style="transform: scale(0.8); margin-right: 4px;">
              </label>
              <span style="font-size: 0.9em; color: #333;">Other</span>
            </div> -->
            <div class="row" style="gap: 16px">
              <!-- Student info form -->
              <div class="col" style="flex: 0 0 calc(50% - 8px)">
                <label for="studentName">Student Name *</label>
                <input id="studentName" name="studentName" type="text" oninput="this.value=this.value.replace(/\d/g,'')" />
              </div>
              <div class="col" style="flex: 0 0 calc(50% - 8px)">
                <label for="motherName">Mother's Name</label>
                <input id="motherName" name="motherName" type="text" oninput="this.value=this.value.replace(/\d/g,'')" />
              </div>
              <div class="col" style="flex: 0 0 calc(33.333% - 10.7px)">
                <label for="fatherName">Father's Name</label>
                <input id="fatherName" name="fatherName" type="text"oninput="this.value=this.value.replace(/\d/g,'')"  />
              </div>
              <div class="col" style="flex: 0 0 calc(33.333% - 10.7px)">
                <label for="class">Class *</label>
                <select id="class" name="class" required>
  <option value="">-- Select Class --</option>
  <option value="30">KG/Nursery</option>
  <!-- <option value="31">LKG</option>
  <option value="32">UKG</option> -->
  <option value="1">1</option>
  <option value="2">2</option>
  <option value="3">3</option>
  <option value="4">4</option>
  <option value="5">5</option>
  <option value="6">6</option>
  <option value="7">7</option>
  <option value="8">8</option>
  <option value="9">9</option>
  <option value="10">10</option>
  <option value="11">11</option>
  <option value="12">12</option>
</select>
              </div>
              <div class="col" style="flex: 0 0 calc(33.333% - 10.7px)">
                <label for="age">Age</label>
                <input id="age" name="age" type="number" 
           oninput="this.value=this.value.replace(/[^0-9]/g,''); 
                    if(this.value > 25) this.value = 25;" 
           max="25" 
                 />
              </div>
              <div class="col" style="flex: 0 0 calc(33.333% - 10.7px)">
                <label for="gender">Gender *</label>
                <select
                  id="gender"
                  name="gender"
                  style="width: 100%; padding: 8px"
                >
                  <option value="">Select Gender</option>
                  <option value="Male">Male</option>
                  <option value="Female">Female</option>
                  <option value="Other">Other</option>
                </select>
              </div>
              <div class="col" style="flex: 0 0 calc(50% - 8px)">
                <label for="udiseId">UDISE ID *</label>
                <input
                  id="udiseId"
                  name="udiseId"
                  type="text"
                  placeholder="Enter your school's UDISE ID"
                  maxlength="11"
                  oninput="this.value=this.value.replace(/[^a-zA-Z0-9]/g,'')" 
                  onblur="validateUdiseField()"
                />
                <div id="udiseValidationStatus" style="margin-top:4px; font-size:0.9em;"></div>
              </div>

              <!-- Image upload -->
              <div class="col" style="display: flex-col">
                <div
                  style="
                    display: flex;
                    align-items: center;
                    gap: 16px;
                    margin-top: 8px;
                  "
                >
                  <div>
                    <label for="upload">Upload Image *</label>
                    <!-- <div class="col" style="flex: 0 0 100%;"> -->
                    <label
                      for="upload"
                      style="
                        padding: 8px 46px;
                        background-color: #f0f0f0;
                        border: 1px solid #ccc;
                        border-radius: 4px;
                        cursor: pointer;
                      "
                    >
                      <span style="color: #333">Choose File</span>
                      <input
                        id="upload"
                        name="upload"
                        type="file"
                        accept="image/*"
                        style="display: none"
                        onchange="previewImage(event)"
                      />
                    </label>
                  </div>
                  <div
                    id="uploadLoader"
                    style="
                      display: none;
                      position: fixed;
                      top: 50%;
                      left: 50%;
                      transform: translate(-50%, -50%);
                      background: rgba(255, 255, 255, 0.8);
                      padding: 32px 48px;
                      border-radius: 8px;
                      z-index: 2000;
                      font-size: 1.2em;
                    "
                  >
                    Uploading image, please wait...
                  </div>

                  <img
                    id="preview"
                    src=""
                    alt="Preview"
                    style="
                      max-width: 150px;
                      max-height: 150px;
                      border: 1px solid #ccc;
                      border-radius: 4px;
                      display: none;
                    "
                  />
                  <!-- <p style="font-size: 0.9em; color: #666;">Image preview will appear here</p> -->
                  <!-- </div> -->
                </div>
              </div>

              <div
                class="col"
                style="flex: 0 0 100%; text-align: left; margin-top: 16px"
              >
                <label style="display: flex; align-items: center; gap: 8px">
                  <input
                    type="checkbox"
                    id="disclaimer"
                    style="width: 16px; height: 16px"
                  />
                  <span style="font-size: 0.8em; color: #666">
                    Disclaimer: By submitting this form, you acknowledge that the information provided is accurate and give consent to use your image publicly. *
                  </span>
                </label>
              </div>
              
              <div id="successStatus" style="margin: 8px 0 0 0; font-size: 0.95em; color: #388e3c;"></div>
              <div
                class="col"
                style="flex: 0 0 100%; text-align: center; margin-top: -36px"
              >
                <button onclick="validateAndStore()">Submit</button>
              </div>

              <!-- Image upload -->
              <!-- <div class="col" style="flex: 0 0 100%;">
              <label for="upload">Upload Image</label>
              <input id="upload" name="upload" type="file" accept="image/*">
              <br><br>
              <img id="preview" src="" alt="Preview" style="max-width: 100%; display: none;" />
            </div> -->

              <!-- <div class="col" style="flex: 0 0 100%; text-align: center;">
              <button onclick="validateAndStore()">Continue</button>
            </div> -->
            </div>
          </div>
        </div>
        

        <!-- Stats section (unchanged) -->
      </div>
      
    </section>
    
    <div style="width:100%;text-align:center;padding:18px 0 0 0;font-size:1em;margin-top:-40px">
      <span style="font-weight:bold; color:#1976d2;">©2025</span> All rights reserved By Ministry Of Education. Technology Partner@ <a href="https://anuvadini.aicte-india.org" target="_blank" style="color:#1976d2; text-decoration:underline;">Anuvadini</a>
    </div>

    <script>
      udiseValidated = false;
      udiseValidationInProgress = false;
      imageUploaded=false;
      let lastValidatedUdiseData = null;
      

// Function to set cookie
function setCookie(name, value, days) {
  const date = new Date();
  date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
  const expires = "expires=" + date.toUTCString();
  document.cookie = name + "=" + value + ";" + expires + ";path=/";
}

// Function to get cookie
function getCookie(name) {
  const nameEQ = name + "=";
  const ca = document.cookie.split(';');
  for(let i=0; i < ca.length; i++) {
    let c = ca[i];
    while (c.charAt(0) === ' ') c = c.substring(1);
    if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length);
  }
  return null;
}

// UDISE validation on blur
async function validateUdiseField() {
  const udiseId = document.getElementById("udiseId").value.trim();
  const statusDiv = document.getElementById("udiseValidationStatus");
  const udiseInput = document.getElementById("udiseId");
  
  udiseValidated = false;
  statusDiv.style.color = "#f44336";
  showSuccessStatus(); // Update status immediately
  
  if (!udiseId) {
    statusDiv.textContent = "";
    return;
  }
  if (!/^[a-zA-Z0-9]{11}$/.test(udiseId)) {
    statusDiv.textContent = "UDISE ID must be exactly 11 alphanumeric characters.";
    return;
  }
  
  statusDiv.style.color = "#333";
  statusDiv.innerHTML = `<span style="color:#1976d2;">Validating UDISE ID...</span>`;
  udiseValidationInProgress = true;
  showSuccessStatus(); // Update status to show pending
  
  try {
    const res = await fetch(`https://ecoclubsbackend.aicte-india.org/api/school-details-from-udise?udiseId=${encodeURIComponent(udiseId)}`, {
      method: "GET",
      headers: { "Content-Type": "application/json" }
    });
    const data = await res.json();
    if (res.ok && data.success) {
      statusDiv.style.color = "#388e3c";
      statusDiv.textContent = "UDISE ID successfully validated.";
      udiseValidated = true;
      udiseInput.disabled = true;
      lastValidatedUdiseData = data.data;
      // Store the data in cookie
      // setCookie("udiseData", JSON.stringify(data.data), 1); // Store for 1 day
      sessionStorage.setItem("udiseData", JSON.stringify(data.data)); // Store in sessionStorage
      localStorage.setItem("udiseData", JSON.stringify(data.data)); // Store in sessionStorage
    } else {
      statusDiv.style.color = "#f44336";
      statusDiv.textContent = data.message || "Invalid UDISE ID. Please check and try again.";
    }
  } catch (e) {
    statusDiv.style.color = "#f44336";
    statusDiv.textContent = "Error validating UDISE ID. Try again.";
  } finally {
    udiseValidationInProgress = false;
    showSuccessStatus(); // Update final status
  }
}

// Patch image upload success
const origHandleFileUpload = handleFileUpload;
handleFileUpload = async function(file) {
  await origHandleFileUpload(file);
  // Check if upload was successful
  const uploadedImage = localStorage.getItem("uploadedImage");
  if (uploadedImage) {
    imageUploaded = true;
    // Disable upload button
    const uploadBtn = document.querySelector('label[for="upload"]');
    uploadBtn.style.pointerEvents = "none";
    uploadBtn.style.opacity = "0.6";
    showSuccessStatus();
  }
};

// Patch image upload event to reset status
document.getElementById("upload").addEventListener("change", () => {
  imageUploaded = false;
  // Re-enable upload button if user changes image
  const uploadBtn = document.querySelector('label[for="upload"]');
  uploadBtn.style.pointerEvents = "auto";
  uploadBtn.style.opacity = "1";
  showSuccessStatus();
});

// Show status below disclaimer
function showSuccessStatus() {
  let msg = "";
  
  // UDISE validation status
  if (udiseValidated) {
    msg += "✔️ UDISE validation successfully completed.<br>";
  } else if (udiseValidationInProgress) {
    msg += "🔄 UDISE validation pending...<br>";
  } else {
    msg += "❌ UDISE validation  pending.<br>";
  }

  // Image upload status
  if (imageUploaded) {
    msg += "✔️ Image successfully uploaded.";
  } else {
    msg += "❌ Image upload pending";
  }

  document.getElementById("successStatus").innerHTML = msg;
}

// Patch UDISE input to reset validation
document.getElementById("udiseId").addEventListener("input", () => {
  udiseValidated = false;
  document.getElementById("successStatus").innerHTML = "";
  document.getElementById("udiseValidationStatus").textContent = "";
});

window.addEventListener('load', () => {
  showSuccessStatus();
});

// Add event listener for form submission
document.querySelector('.form-container button').addEventListener('click', async (e) => {
  e.preventDefault();
  
  // Trigger UDISE validation if not already validated
  const udiseId = document.getElementById("udiseId").value.trim();
  if (udiseId && !udiseValidated) {
    await validateUdiseField();
  }
  
  
});

// Add event listener for input change
document.getElementById("udiseId").addEventListener('input', () => {
  udiseValidated = false;
  document.getElementById("udiseValidationStatus").textContent = "";
  showSuccessStatus();
});

// Add event listener for window unload
window.addEventListener('beforeunload', () => {
  const udiseId = document.getElementById("udiseId").value.trim();
  if (udiseId && !udiseValidated) {
    validateUdiseField();
  }
});
</script>
<script>
// Helper to format numbers as K, lakh, cr
function formatNumber(num) {
  if (num >= 1e7) return (num / 1e7).toFixed(2).replace(/\.0$/, '') + ' cr';
  if (num >= 1e5) return (num / 1e5).toFixed(2).replace(/\.0$/, '') + ' L';
  if (num >= 1e3) return (num / 1e3).toFixed(2).replace(/\.0$/, '') + ' k';
  return num;
}
function formatNumberone(num) {
  if (num >= 1e7) return (num / 1e7).toFixed(1).replace(/\.0$/, '') + ' cr';
  if (num >= 1e5) return (num / 1e5).toFixed(1).replace(/\.0$/, '') + ' L';
  if (num >= 1e3) return (num / 1e3).toFixed(1).replace(/\.0$/, '') + ' k';
  return num;
}

async function fetchStats() {
  try {
    const res = await fetch('./stats.json');
    const data = await res.json();
    document.getElementById('totalImagesUploaded').textContent =
      data.totalImagesUploaded != null ? formatNumber(data.totalImagesUploaded) : '--';
    document.getElementById('certificatesDownloaded').textContent =
      data.certificatesDownloaded != null ? formatNumberone(data.certificatesDownloaded) : '--';
    document.getElementById('notificationCount').textContent =
      data.notificationCount != null ? formatNumberone(data.notificationCount) : '--';
  } catch (e) {
    document.getElementById('totalImagesUploaded').textContent = '--';
    document.getElementById('certificatesDownloaded').textContent = '--';
    document.getElementById('notificationCount').textContent = '--';
  }
}
window.addEventListener('DOMContentLoaded', fetchStats);
</script>


    <!-- Image compression script -->
    <script src="https://unpkg.com/browser-image-compression/dist/browser-image-compression.js"></script>
    <script>
      async function handleFileUpload(file) {
        const loader = document.getElementById("uploadLoader");
        const preview = document.getElementById("preview");

        try {
          // Show loader
          loader.style.display = "block";
          const formData = new FormData();
          formData.append("files", file);

          const res = await fetch(
            "https://ecoclubsai.aicte-india.org/api/upload-image-file",
            {
              method: "POST",
              body: formData,
            }
          );

          const responseData = await res.json();

          // Create toast element
          const toast = document.createElement("div");
          toast.style.position = "fixed";
          toast.style.top = "20px";
          toast.style.right = "20px";
          toast.style.padding = "16px";
          toast.style.borderRadius = "4px";
          toast.style.color = "#fff";
          toast.style.zIndex = "1000";
          toast.style.transition = "all 0.9s ease";

          if (responseData.status === "success") {
            // ✅ Success toast
            toast.style.backgroundColor = "#4CAF50";
            toast.textContent = "Image uploaded successfully!";
            localStorage.setItem("uploadedImage", responseData.fileUrl);
            // Disable upload button and show success status
            const uploadBtn = document.querySelector('label[for="upload"]');
            uploadBtn.style.pointerEvents = "none";
            uploadBtn.style.opacity = "0.6";
            imageUploaded = true;
            showSuccessStatus();
          } else {
            preview.src = "";
            preview.style.display = "none";
            const analysis = responseData.analysis;

            // ✅ New logic: Only check planting
            if (analysis.planting === "NO") {
              toast.style.backgroundColor = "#f44336";
              toast.textContent =
                "Image rejected because: Planting process not visible. Please upload another image.";
              imageUploaded = false;
              showSuccessStatus();
            } else {
              // Even if child/woman not present, still accept
              toast.style.backgroundColor = "#4CAF50";
              toast.textContent = "Image uploaded successfully!";
              localStorage.setItem("uploadedImage", responseData.fileUrl);
              const uploadBtn = document.querySelector('label[for="upload"]');
              uploadBtn.style.pointerEvents = "none";
              uploadBtn.style.opacity = "0.6";
              imageUploaded = true;
              showSuccessStatus();
            }
          }

          document.body.appendChild(toast);
          setTimeout(() => {
            toast.remove();
          }, 5000);

          if (responseData.status === "success") {
            const uploaded = responseData.fileUrl;
            console.log(uploaded, "Uploaded photo");
          }
        } catch (err) {
          console.error(err);
          preview.src = "";
          preview.style.display = "none";
          const toast = document.createElement("div");
          toast.style.position = "fixed";
          toast.style.top = "20px";
          toast.style.right = "20px";
          toast.style.padding = "16px";
          toast.style.borderRadius = "4px";
          toast.style.backgroundColor = "#f44336";
          toast.style.color = "#fff";
          toast.textContent = "Unexpected error while uploading image";
          document.body.appendChild(toast);
          setTimeout(() => {
            toast.remove();
          }, 5000);
        } finally {
          loader.style.display = "none";
        }
      }

      document
        .getElementById("upload")
        .addEventListener("change", async (e) => {
          const file = e.target.files[0];
          if (!file) return;

          // Check file type
          const allowedExtensions = ["png", "jpeg", "jpg"];
          const ext = file.type.split("/")[1];
          if (!allowedExtensions.includes(ext)) {
            alert("Only PNG, JPEG and JPG files are allowed");
            e.target.value = "";
            return;
          }

          const options = {
            maxSizeMB: 1,
            maxWidthOrHeight: 1024,
            useWebWorker: true,
          };
          const pad = (n) => n.toString().padStart(2, "0");

          // build a YYYYMMDD_HHMMSS timestamp
          const now = new Date(); // local time (Asia/Kolkata for you)
          const timestamp =
            `${now.getFullYear()}${pad(now.getMonth() + 1)}${pad(now.getDate())}_` +
            `${pad(now.getHours())}${pad(now.getMinutes())}${pad(now.getSeconds())}`;

          // split the original name into "basename" and "extension"
          const dotIndex = file.name.lastIndexOf(".");
          const baseName = dotIndex !== -1 ? file.name.slice(0, dotIndex) : file.name;
          const extension = dotIndex !== -1 ? file.name.slice(dotIndex) : "";

          try {
            let compressedFile = await imageCompression(file, options);
            console.log(compressedFile);

            // Create a new File object with the original name
            const renamedFile = new File(
              [compressedFile],
              `${baseName}_${timestamp}${extension}`,
              {
                type: compressedFile.type,
                lastModified: Date.now(),
              }
            );

            const compressedUrl = URL.createObjectURL(renamedFile);

            // Show preview
            const preview = document.getElementById("preview");
            preview.src = compressedUrl;
            preview.style.display = "block";
            console.log(renamedFile.size, "Compressed file");
            console.log(file.size, "Original file");

            // Upload the file with the original name
            await handleFileUpload(renamedFile);
          } catch (error) {
            console.error("Image processing failed:", error);
            alert("Image processing failed");
          }
        });
</script>


   <script>
  async function validateAndStore() {
    const studentName = document.getElementById("studentName").value.trim();
    const motherName = document.getElementById("motherName").value.trim();
    const fatherName = document.getElementById("fatherName").value.trim();
    const studentClass = document.getElementById("class").value.trim();
    const age = document.getElementById("age").value.trim();
    const gender = document.getElementById("gender").value;
    const udiseId = document.getElementById("udiseId").value.trim();
    const disclaimer = document.getElementById("disclaimer").checked;
    const uploadedImage = localStorage.getItem("uploadedImage"); // Use sessionStorage instead of localStorage
    // const userType = document.querySelector('input[name="userType"]:checked').value;
    // alert(userType)
    // Validate required fields
    if (!studentName || !(motherName || fatherName) || !studentClass || !gender || !udiseId) {
      alert("Please fill all required fields");
      return;
    }

   
    if(!udiseValidated) {
      alert("Please validate your UDISE ID first.");
      return;
    }

    // Validate image upload
    if (!uploadedImage) {
      alert("Please upload an image and wait for successful upload.");
      return;
    }

    // Validate disclaimer
    if (!disclaimer) {
      alert("Please accept the disclaimer.");
      return;
    }

    // Get UDISE data from sessionStorage
    const udiseData = sessionStorage.getItem("udiseData") || localStorage.getItem("udiseData");

    const payload = {
      studentName,
      motherName,
      fatherName,
      class: studentClass,
      age,
      gender,
      udiseId,
      imageUrl: uploadedImage,
      udiseData: udiseData ? JSON.parse(udiseData) : lastValidatedUdiseData
    };

    try {
      const res = await fetch("https://ecoclubsbackend.aicte-india.org/api/ekped-maakenaamevent", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload),
      });
      const data = await res.json();
      if (res.ok && data.status === "success") {
        // sessionStorage.setItem("formSubmissionData", JSON.stringify(data));
        setCookie("formSubmissionData", JSON.stringify(data), 1); // Store for 1 day
        alert("Details submitted successfully!");
        // Optionally redirect or show certificate download
        const formContainer = document.querySelector(".form-container");
        formContainer.innerHTML = `
          <div style="text-align: center; margin-top: 20px;">
            <button 
              class="button green" 
              style="margin: 10px; padding: 12px 24px;"
              onclick="location.href='https://ecoclubs.education.gov.in/certificate'"
            >
              Download Certificate
            </button>
          </div>
        `;
      } else {
        alert("Submission failed: " + (data.message || "Unknown error"));
      }
    } catch (err) {
      alert("Error submitting details. Please try again.");
      console.error(err);
    }
  }
</script>
<script>
  function openHelplineModal() {
    document.getElementById("helplineModal").style.display = "flex";
  }

  function closeHelplineModal() {
    document.getElementById("helplineModal").style.display = "none";
  }
</script>

 <!-- Helpline Modal -->
<!-- Helpline Modal -->
<div id="helplineModal" style="
  display: none;
  position: fixed; 
  top: 0; 
  left: 0; 
  width: 100%; 
  height: 100%; 
  background: rgba(0,0,0,0.6); 
  z-index: 9999;
  justify-content: center; 
  align-items: center;
">
  <div style="
    background: #fff; 
    padding: 32px; 
    border-radius: 8px; 
    max-width: 400px; 
    width: 90%;
    text-align: left;
    box-shadow: 0 4px 20px rgba(0,0,0,0.3);
    position: relative;
    animation: fadeIn 0.3s ease;
  ">
    <!-- <h2 style="margin-top: 0; color: #1976d2;">EcoClub Helpline</h2> -->
    <p><strong>Contact Number:</strong> 011-29581423</p>
    <p><strong>Staff Responding to Calls:</strong></p>
    <p>1. Naveen Kaushik: 9050927394</p>
    <p>2. Rohit Phalswal: 9773795440</p>
    <button onclick="closeHelplineModal()" style="
      margin-top: 20px;
      background: #1976d2;
      color: #fff;
      border: none;
      padding: 8px 16px;
      border-radius: 4px;
      cursor: pointer;
    ">
      Close
    </button>
  </div>
</div>

<style>
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(-10px); }
  to { opacity: 1; transform: translateY(0); }
}
</style>
<script>
(function initMediaSlider(){
  const slider = document.getElementById('mediaSlider');
  if (!slider) return;

  const slideEls = Array.from(slider.querySelectorAll('.slide'));
  const prevBtn = slider.querySelector('.nav.prev');
  const nextBtn = slider.querySelector('.nav.next');
  const dotsWrap = slider.querySelector('#mediaDots');

  let index = Math.max(0, slideEls.findIndex(s => s.classList.contains('active')));
  if (index === -1) index = 0;

  // Build dots
  slideEls.forEach((_, i) => {
    const b = document.createElement('button');
    b.setAttribute('aria-label', `Go to slide ${i+1}`);
    if (i === index) b.classList.add('active');
    b.addEventListener('click', () => show(i));
    dotsWrap.appendChild(b);
  });

  const dotEls = Array.from(dotsWrap.querySelectorAll('button'));

  function pauseAllVideos(){
    slideEls.forEach(slide => {
      const v = slide.querySelector('video');
      if (v) { v.pause(); v.currentTime = Math.min(v.currentTime, (v.duration || v.currentTime)); }
    });
  }

  function show(i){
    if (i < 0) i = slideEls.length - 1;
    if (i >= slideEls.length) i = 0;

    pauseAllVideos();

    slideEls[index].classList.remove('active');
    dotEls[index]?.classList.remove('active');

    index = i;

    slideEls[index].classList.add('active');
    dotEls[index]?.classList.add('active');
  }

  prevBtn.addEventListener('click', () => show(index - 1));
  nextBtn.addEventListener('click', () => show(index + 1));

  // Basic swipe support
  let startX = 0, endX = 0;
  slider.addEventListener('touchstart', e => { startX = e.changedTouches[0].clientX; }, {passive:true});
  slider.addEventListener('touchend', e => {
    endX = e.changedTouches[0].clientX;
    const delta = endX - startX;
    if (Math.abs(delta) > 40) {
      if (delta > 0) show(index - 1); else show(index + 1);
    }
  }, {passive:true});
})();
</script>
<script>
const vid = document.getElementById('promoVideo');

function unmuteVideo() {
  if (vid && vid.muted) {
    vid.muted = false;
  }
  document.removeEventListener('click', unmuteVideo);
  document.removeEventListener('touchstart', unmuteVideo);
}

document.addEventListener('click', unmuteVideo);
document.addEventListener('touchstart', unmuteVideo);
</script>


    
  </body>
</html>
